[[toc]]

# 智控台灯扩展创新

> 案例：
>
> 1 按钮控制台灯（维持状态）
>
> 2 按钮控制台灯（多档变频）
>
> 3 七彩灯



## 1 按钮控制台灯（维持状态）

**功能：完成一次完整的按键动作（按下+松开），使台灯能够维系亮或灭的状态，即按一次，亮；再按一次，灭。**

<a href="/tutorial/cfdsx/sb3/按钮控制台灯（维持状态）.sb3">点击下载：按钮控制台灯（维持状态）.sb3</a>

![image-20240925213432225](/智控台灯扩展创新.assets/image-20240925213432225.png)

①  这里没有像之前案例比较读取电平返回值是否等于1，是因为在程序中，数值`1`做判断语句条件时会被自动转化为逻辑`真`; 而数值`0`则会被转化为逻辑`假`。因此，当按钮按下时，得到高电平数字信号`1`在这里会被当作条件成立处理，执行后续那么里的语句。

②  延时是为了消除按钮抖动的影响。现在只要确保在按下按钮0.5秒内松开按钮，程序即可分辨一次完整的按键动作（按下松开），而不会因为过快的执行频率误测多次。

③  每进行一次按键动作，变量`标志`就会在数值1和-1之间进行一次转化。



## 2 按钮控制台灯（多档变频）

**功能：按钮控制台灯在多种亮度模式下切换**

<a href="/tutorial/cfdsx/sb3/按钮控制台灯（多档变频）.sb3">点击下载：按钮控制台灯（多档变频）.sb3</a>

![image-20240925220527979](/智控台灯扩展创新.assets/image-20240925220527979.png)

①  每完成一次按键动作（按下松开），变量`标志`值自增1

②  亮度会在四种档位切换，调用如下语句，可调节灯盘的亮度以及闪烁频率，占空比取值0（熄灭）-100（最亮）。

![image-20240925221808259](/智控台灯扩展创新.assets/image-20240925221808259.png)

③  为实现其在多个档位间循环切换，在其升至最高档位, 即`标志` == 3时，再次按键，使`标志`置0，灯盘回到熄灭状态。



## 3 七彩灯

**功能**：使台灯能够发出不同颜色的光线。

<a href="/tutorial/cfdsx/sb3/七彩灯.sb3">点击下载：七彩灯.sb3</a>

色光的实现，原理上依靠RGB三色通道的混合达成。利用输出PWM波的语句，调整每个通道的占空比以获得不同比例。

![image-20240925224919119](/智控台灯扩展创新.assets/image-20240925224919119.png)